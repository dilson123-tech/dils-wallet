<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Dils Wallet – Smoke Test</title>
  <style>
    body { font-family: system-ui, sans-serif; background:#f6f7fb; margin:0; padding:24px; }
    .card { background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:16px; max-width:880px; margin:0 auto 16px; box-shadow:0 1px 2px rgba(0,0,0,.06); }
    table { width:100%; border-collapse:collapse; font-size:14px; }
    th { background:#f3f4f6; text-align:left; padding:8px; }
    td { border-top:1px solid #e5e7eb; padding:8px; }
    .row { display:flex; gap:12px; }
    .row input { flex:1; padding:10px 12px; border:1px solid #d1d5db; border-radius:8px; }
    button { padding:10px 14px; border:0; border-radius:8px; background:#2563eb; color:#fff; cursor:pointer; }
    pre { background:#0b1020; color:#d1e7ff; padding:12px; border-radius:8px; overflow:auto; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Auth rápido</h2>
    <div class="row">
      <input id="email" type="email" placeholder="email" value="teste@exemplo.com">
      <input id="pass" type="password" placeholder="senha" value="123456">
      <button onclick="registrar()">/auth/register</button>
      <button onclick="logar()">/auth/login</button>
    </div>
  </div>

  <div class="card">
    <h3>Resposta</h3>
    <pre id="out">{ }</pre>
  </div>
<script>
const BASE = 'https://dils-wallet-production.up.railway.app';
const out = (o) => document.getElementById('out').textContent =
  JSON.stringify(o, null, 2);

async function registrar(){
  const body = {
    email: document.getElementById('email').value,
    password: document.getElementById('pass').value,
    full_name: 'Smoke Test'
  };
  try {
    const r = await fetch(`${BASE}/api/v1/auth/register`, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify(body)
    });
    out({status:r.status, data: await r.json().catch(()=> ({}))});
  } catch(e){ out({error:String(e)}); }
}

async function logar(){
  const fd = new URLSearchParams();
  fd.set('username', document.getElementById('email').value);
  fd.set('password', document.getElementById('pass').value);
  try {
    const r = await fetch(`${BASE}/api/v1/auth/login`, {
      method: 'POST',
      headers: {'Content-Type':'application/x-www-form-urlencoded'},
      body: fd.toString()
    });
    out({status:r.status, data: await r.json().catch(()=> ({}))});
  } catch(e){ out({error:String(e)}); }
}
</script>
</body>
</html>
