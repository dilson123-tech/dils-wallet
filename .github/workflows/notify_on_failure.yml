name: notify-on-failure (workflow_run)

on:
  workflow_run:
    workflows:
      - CI - dils-wallet
      - smoke-pix
      - Smoke Prod
      - health-prod
      - Smoke - PIX Idempotency
      - Fail Fast
      - CD - Publish Docker image (GHCR)
    types: [completed]
    branches: [main]

jobs:
  notify:
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    runs-on: ubuntu-latest
    steps:
      - name: Print failure info
        run: |
          echo "FAILED WORKFLOW: ${{ github.event.workflow_run.name }}"
          echo "URL: ${{ github.event.workflow_run.html_url }}"
          echo "HEAD_BRANCH: ${{ github.event.workflow_run.head_branch }}"
          echo "HEAD_SHA: ${{ github.event.workflow_run.head_sha }}"
