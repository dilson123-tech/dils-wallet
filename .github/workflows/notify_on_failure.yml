name: notify-on-failure (workflow_run)

on:
  workflow_run:
    workflows: ["CI", "smoke-pix", "health-prod"]
    types: [completed]

jobs:
  notify:
    if: ${{ github.event.workflow_run.head_branch == 'main' && github.event.workflow_run.conclusion == 'failure' }}
    runs-on: ubuntu-latest
    steps:
      - name: Print failure info
        run: |
          echo "‚ùå Workflow FAILED: ${{ github.event.workflow_run.name }}"
          echo "CONCLUSION: ${{ github.event.workflow_run.conclusion }}"
          echo "URL:        ${{ github.event.workflow_run.html_url }}"
